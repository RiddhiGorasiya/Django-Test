{% extends "myapp/base.html" %}
{% block content %}
<div class="row">
    <div class="col-sm-4">
        <h4 class="text-center alert alert-info">Add New Student</h4>
        <form action="" method="POST" novalidate>
            {% csrf_token %}
            {{form.as_p}}
            <input type="submit" class="btn btn-success" value="Add">
        </form>
        <style>
            .success{
                color:green;
            }
        </style>
        {% if messages %}
            {% for messages in messages %}
                <span class="{{messages.tags}}">{{messages}}</span>
            {% endfor %}
        {% endif %} 
    </div>
    <div class="col-sm-8">
        <h4 class="text-center alert alert-info">Show Student Information</h4>
        <!--  Filter & Sort Form -->
        <form method="get" class="mb-3 p-3 border rounded bg-light">
        <div class="row g-2">
            <div class="col-md-3">
            <input type="text" name="search" class="form-control" placeholder="Search by name/email" value="{{ search }}">
            </div>
            <div class="col-md-2">
            <input type="number" name="id_min" class="form-control" placeholder="Min ID" value="{{ id_min }}">
            </div>
            <div class="col-md-2">
            <input type="number" name="id_max" class="form-control" placeholder="Max ID" value="{{ id_max }}">
            </div>
            <div class="col-md-2">
            <select name="sort" class="form-select">
                <option value="id" {% if sort_by == "id" %}selected{% endif %}>ID</option>
                <option value="name" {% if sort_by == "name" %}selected{% endif %}>Name</option>
                <option value="email" {% if sort_by == "email" %}selected{% endif %}>Email</option>
            </select>
            </div>
            <div class="col-md-2">
            <select name="order" class="form-select">
                <option value="asc" {% if order == "asc" %}selected{% endif %}>Ascending</option>
                <option value="desc" {% if order == "desc" %}selected{% endif %}>Descending</option>
            </select> 
            </div>
            <div class="col-md-1">
            <button type="submit" class="btn btn-primary ">Search</button>
            </div>
        </div>
        </form>
        {% if stu %}
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Name</th>
                        <th scope="col">Email</th>
                        <th scope="col">Pasword</th>
                        <th scope="col">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for st in stu %}
                        <tr>
                            <th scope="row">{{st.id}}</th>
                            <td>{{st.name}}</td>
                            <td>{{st.email}}</td>
                            <td>{{st.password}}</td>
                            <td>
                                <a href="{% url "updatedata" st.id %}" class="btn btn-warning btn-sm">Edit</a>
                                <form action="{% url "deletedata" st.id %}" method="POST" class="d-inline">
                                    {% csrf_token %}
                                    <input type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this student?');" value="Delete">
                                </form>                         
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <h4 class="text-center alert alert-warning">No Record</h4>
        {% endif %}
        {% comment %} add Pagination {% endcomment %}
        {% comment %} <style>
            .pagination {
                display: flex;
                justify-content: center;
                align-items: center;
                margin: 0.1px 0;
                font-family: Arial, sans-serif;
            }

            .pagination a, 
            .pagination span {
                color: #007bff;
                text-decoration: none;
                padding: 8px 14px;
                margin: 0 4px;
                {% comment %} border: 1px solid #dee2e6; {% endcomment %}
                {% comment %} border-radius: 4px;
                font-size: 14px;
                transition: background-color 0.3s, color 0.3s, border-color 0.3s;
            }

            .pagination a:hover {
                background-color: #007bff;
                color: white;
                border-color: #007bff;
            }

            .pagination .current {
                background-color: #007bff;
                color: white;
                border-color: #007bff;
                cursor: default;
            }
        </style> {% endcomment %}

        {% comment %} <div class="pagination">
            <span>
                {% if stu.has_previous %}
                    <a href="?page={{stu.previous_page_number}}">Previous</a>
                {% endif %}
                <span class="current">
                    Page {{ stu.number }} of {{ stu.paginator.num_pages }}
                </span> 
                {% if stu.has_next %}
                    <a href="?page={{stu.next_page_number}}">Next</a>
                {% endif %}
            </span> 
        </div> {% endcomment %} 
        {% comment %} <div class="pagination justify-content-center mt-3">
            {% if stu.has_previous %}
            <a class="btn btn-outline-primary mx-1" href="?page={{ stu.previous_page_number }}">Previous</a>
            {% endif %}
            <span class="btn btn-primary">
                Page {{ stu.number }} of {{ stu.paginator.num_pages }}
            </span>
            {% if stu.has_next %}
            <a class="btn btn-outline-primary mx-1" href="?page={{ stu.next_page_number }}">Next</a>
            {% endif %}
        </div> {% endcomment %}
         <div class="d-flex justify-content-center align-items-center mt-3">
      {% if stu.has_previous %}
        <a class="btn btn-outline-primary mx-1"
           href="?page={{ stu.previous_page_number }}{% if preserved_query %}&{{ preserved_query }}{% endif %}">
           Previous</a>
      {% endif %}
      <span class="btn btn-primary mx-1">Page {{ stu.number }} of {{ stu.paginator.num_pages }}</span>
      {% if stu.has_next %}
        <a class="btn btn-outline-primary mx-1"
           href="?page={{ stu.next_page_number }}{% if preserved_query %}&{{ preserved_query }}{% endif %}">
           Next</a>
      {% endif %}
    </div>
    </div>
</div>
{% endblock content %}